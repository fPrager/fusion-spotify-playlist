// Copyright 2018-2022 the Deno authors. All rights reserved. MIT license.
// Copyright Joyent and Node contributors. All rights reserved. MIT license.
import { Readline } from "../internal/readline/promises.mjs";
import { Interface as _Interface, kQuestion, kQuestionCancel } from "../internal/readline/interface.mjs";
import { AbortError } from "../internal/errors.ts";
import { validateAbortSignal } from "../internal/validators.mjs";
import { kEmptyObject } from "../internal/util.mjs";
export class Interface extends _Interface {
    constructor(input, output, completer, terminal){
        super(input, output, completer, terminal);
    }
    question(query, options = kEmptyObject) {
        return new Promise((resolve, reject)=>{
            let cb = resolve;
            if (options?.signal) {
                validateAbortSignal(options.signal, "options.signal");
                if (options.signal.aborted) {
                    return reject(new AbortError(undefined, {
                        cause: options.signal.reason
                    }));
                }
                const onAbort = ()=>{
                    this[kQuestionCancel]();
                    reject(new AbortError(undefined, {
                        cause: options.signal.reason
                    }));
                };
                options.signal.addEventListener("abort", onAbort, {
                    once: true
                });
                cb = (answer)=>{
                    options.signal.removeEventListener("abort", onAbort);
                    resolve(answer);
                };
            }
            this[kQuestion](query, cb);
        });
    }
}
export function createInterface(inputOrOptions, output, completer, terminal) {
    return new Interface(inputOrOptions, output, completer, terminal);
}
export { Readline };
export default {
    Interface,
    Readline,
    createInterface
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3N0ZEAwLjE2Ny4wL25vZGUvcmVhZGxpbmUvcHJvbWlzZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTgtMjAyMiB0aGUgRGVubyBhdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLiBNSVQgbGljZW5zZS5cbi8vIENvcHlyaWdodCBKb3llbnQgYW5kIE5vZGUgY29udHJpYnV0b3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLiBNSVQgbGljZW5zZS5cblxuaW1wb3J0IHsgUmVhZGxpbmUgfSBmcm9tIFwiLi4vaW50ZXJuYWwvcmVhZGxpbmUvcHJvbWlzZXMubWpzXCI7XG5cbmltcG9ydCB7XG4gIEludGVyZmFjZSBhcyBfSW50ZXJmYWNlLFxuICBrUXVlc3Rpb24sXG4gIGtRdWVzdGlvbkNhbmNlbCxcbn0gZnJvbSBcIi4uL2ludGVybmFsL3JlYWRsaW5lL2ludGVyZmFjZS5tanNcIjtcbmltcG9ydCB7IEFib3J0RXJyb3IgfSBmcm9tIFwiLi4vaW50ZXJuYWwvZXJyb3JzLnRzXCI7XG5pbXBvcnQgeyB2YWxpZGF0ZUFib3J0U2lnbmFsIH0gZnJvbSBcIi4uL2ludGVybmFsL3ZhbGlkYXRvcnMubWpzXCI7XG5cbmltcG9ydCB7IGtFbXB0eU9iamVjdCB9IGZyb20gXCIuLi9pbnRlcm5hbC91dGlsLm1qc1wiO1xuaW1wb3J0IHR5cGUgeyBBYm9ydGFibGUgfSBmcm9tIFwiLi4vX2V2ZW50cy5kLnRzXCI7XG5pbXBvcnQgdHlwZSB7XG4gIEFzeW5jQ29tcGxldGVyLFxuICBDb21wbGV0ZXIsXG4gIFJlYWRMaW5lT3B0aW9ucyxcbn0gZnJvbSBcIi4uL19yZWFkbGluZV9zaGFyZWRfdHlwZXMuZC50c1wiO1xuXG5pbXBvcnQgdHlwZSB7IFJlYWRhYmxlU3RyZWFtLCBXcml0YWJsZVN0cmVhbSB9IGZyb20gXCIuLi9fZ2xvYmFsLmQudHNcIjtcblxuLyoqXG4gKiBUaGUgYHJlYWRsaW5lL3Byb21pc2VgIG1vZHVsZSBwcm92aWRlcyBhbiBBUEkgZm9yIHJlYWRpbmcgbGluZXMgb2YgaW5wdXQgZnJvbSBhIFJlYWRhYmxlIHN0cmVhbSBvbmUgbGluZSBhdCBhIHRpbWUuXG4gKlxuICogQHNlZSBbc291cmNlXShodHRwczovL2dpdGh1Yi5jb20vbm9kZWpzL25vZGUvYmxvYi92MTguMC4wL2xpYi9yZWFkbGluZS9wcm9taXNlcy5qcylcbiAqIEBzaW5jZSB2MTcuMC4wXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSW50ZXJmYWNlIGV4dGVuZHMgX0ludGVyZmFjZSB7XG4gIC8qKlxuICAgKiBUaGUgcmwucXVlc3Rpb24oKSBtZXRob2QgZGlzcGxheXMgdGhlIHF1ZXJ5IGJ5IHdyaXRpbmcgaXQgdG8gdGhlIG91dHB1dCwgd2FpdHMgZm9yIHVzZXIgaW5wdXQgdG8gYmUgcHJvdmlkZWQgb24gaW5wdXQsXG4gICAqIHRoZW4gaW52b2tlcyB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gcGFzc2luZyB0aGUgcHJvdmlkZWQgaW5wdXQgYXMgdGhlIGZpcnN0IGFyZ3VtZW50LlxuICAgKlxuICAgKiBXaGVuIGNhbGxlZCwgcmwucXVlc3Rpb24oKSB3aWxsIHJlc3VtZSB0aGUgaW5wdXQgc3RyZWFtIGlmIGl0IGhhcyBiZWVuIHBhdXNlZC5cbiAgICpcbiAgICogSWYgdGhlIHJlYWRsaW5lUHJvbWlzZXMuSW50ZXJmYWNlIHdhcyBjcmVhdGVkIHdpdGggb3V0cHV0IHNldCB0byBudWxsIG9yIHVuZGVmaW5lZCB0aGUgcXVlcnkgaXMgbm90IHdyaXR0ZW4uXG4gICAqXG4gICAqIElmIHRoZSBxdWVzdGlvbiBpcyBjYWxsZWQgYWZ0ZXIgcmwuY2xvc2UoKSwgaXQgcmV0dXJucyBhIHJlamVjdGVkIHByb21pc2UuXG4gICAqXG4gICAqIEV4YW1wbGUgdXNhZ2U6XG4gICAqXG4gICAqIGBgYGpzXG4gICAqIGNvbnN0IGFuc3dlciA9IGF3YWl0IHJsLnF1ZXN0aW9uKCdXaGF0IGlzIHlvdXIgZmF2b3JpdGUgZm9vZD8gJyk7XG4gICAqIGNvbnNvbGUubG9nKGBPaCwgc28geW91ciBmYXZvcml0ZSBmb29kIGlzICR7YW5zd2VyfWApO1xuICAgKiBgYGBcbiAgICpcbiAgICogVXNpbmcgYW4gQWJvcnRTaWduYWwgdG8gY2FuY2VsIGEgcXVlc3Rpb24uXG4gICAqXG4gICAqIGBgYGpzXG4gICAqIGNvbnN0IHNpZ25hbCA9IEFib3J0U2lnbmFsLnRpbWVvdXQoMTBfMDAwKTtcbiAgICpcbiAgICogc2lnbmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgKCkgPT4ge1xuICAgKiAgIGNvbnNvbGUubG9nKCdUaGUgZm9vZCBxdWVzdGlvbiB0aW1lZCBvdXQnKTtcbiAgICogfSwgeyBvbmNlOiB0cnVlIH0pO1xuICAgKlxuICAgKiBjb25zdCBhbnN3ZXIgPSBhd2FpdCBybC5xdWVzdGlvbignV2hhdCBpcyB5b3VyIGZhdm9yaXRlIGZvb2Q/ICcsIHsgc2lnbmFsIH0pO1xuICAgKiBjb25zb2xlLmxvZyhgT2gsIHNvIHlvdXIgZmF2b3JpdGUgZm9vZCBpcyAke2Fuc3dlcn1gKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBzaW5jZSB2MTcuMC4wXG4gICAqIEBwYXJhbSBxdWVyeSBBIHN0YXRlbWVudCBvciBxdWVyeSB0byB3cml0ZSB0byBvdXRwdXQsIHByZXBlbmRlZCB0byB0aGUgcHJvbXB0LlxuICAgKi9cbiAgcXVlc3Rpb24ocXVlcnk6IHN0cmluZywgb3B0aW9ucz86IEFib3J0YWJsZSk6IFByb21pc2U8c3RyaW5nPjtcbn1cblxuZXhwb3J0IGNsYXNzIEludGVyZmFjZSBleHRlbmRzIF9JbnRlcmZhY2Uge1xuICBjb25zdHJ1Y3RvcihcbiAgICBpbnB1dDogUmVhZGFibGVTdHJlYW0gfCBSZWFkTGluZU9wdGlvbnMsXG4gICAgb3V0cHV0PzogV3JpdGFibGVTdHJlYW0sXG4gICAgY29tcGxldGVyPzogQ29tcGxldGVyIHwgQXN5bmNDb21wbGV0ZXIsXG4gICAgdGVybWluYWw/OiBib29sZWFuLFxuICApIHtcbiAgICBzdXBlcihpbnB1dCwgb3V0cHV0LCBjb21wbGV0ZXIsIHRlcm1pbmFsKTtcbiAgfVxuICBxdWVzdGlvbihxdWVyeTogc3RyaW5nLCBvcHRpb25zOiBBYm9ydGFibGUgPSBrRW1wdHlPYmplY3QpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBsZXQgY2IgPSByZXNvbHZlO1xuXG4gICAgICBpZiAob3B0aW9ucz8uc2lnbmFsKSB7XG4gICAgICAgIHZhbGlkYXRlQWJvcnRTaWduYWwob3B0aW9ucy5zaWduYWwsIFwib3B0aW9ucy5zaWduYWxcIik7XG4gICAgICAgIGlmIChvcHRpb25zLnNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgICAgcmV0dXJuIHJlamVjdChcbiAgICAgICAgICAgIG5ldyBBYm9ydEVycm9yKHVuZGVmaW5lZCwgeyBjYXVzZTogb3B0aW9ucy5zaWduYWwucmVhc29uIH0pLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBvbkFib3J0ID0gKCkgPT4ge1xuICAgICAgICAgIHRoaXNba1F1ZXN0aW9uQ2FuY2VsXSgpO1xuICAgICAgICAgIHJlamVjdChuZXcgQWJvcnRFcnJvcih1bmRlZmluZWQsIHsgY2F1c2U6IG9wdGlvbnMhLnNpZ25hbCEucmVhc29uIH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgb3B0aW9ucy5zaWduYWwuYWRkRXZlbnRMaXN0ZW5lcihcImFib3J0XCIsIG9uQWJvcnQsIHsgb25jZTogdHJ1ZSB9KTtcbiAgICAgICAgY2IgPSAoYW5zd2VyKSA9PiB7XG4gICAgICAgICAgb3B0aW9ucyEuc2lnbmFsIS5yZW1vdmVFdmVudExpc3RlbmVyKFwiYWJvcnRcIiwgb25BYm9ydCk7XG4gICAgICAgICAgcmVzb2x2ZShhbnN3ZXIpO1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICB0aGlzW2tRdWVzdGlvbl0ocXVlcnksIGNiKTtcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIFRoZSBgcmVhZGxpbmVQcm9taXNlcy5jcmVhdGVJbnRlcmZhY2UoKWAgbWV0aG9kIGNyZWF0ZXMgYSBuZXcgYHJlYWRsaW5lUHJvbWlzZXMuSW50ZXJmYWNlYCBpbnN0YW5jZS5cbiAqXG4gKiBgYGBqc1xuICogY29uc3QgcmVhZGxpbmVQcm9taXNlcyA9IHJlcXVpcmUoJ25vZGU6cmVhZGxpbmUvcHJvbWlzZXMnKTtcbiAqIGNvbnN0IHJsID0gcmVhZGxpbmVQcm9taXNlcy5jcmVhdGVJbnRlcmZhY2Uoe1xuICogICBpbnB1dDogcHJvY2Vzcy5zdGRpbixcbiAqICAgb3V0cHV0OiBwcm9jZXNzLnN0ZG91dFxuICogfSk7XG4gKiBgYGBcbiAqXG4gKiBPbmNlIHRoZSBgcmVhZGxpbmVQcm9taXNlcy5JbnRlcmZhY2VgIGluc3RhbmNlIGlzIGNyZWF0ZWQsIHRoZSBtb3N0IGNvbW1vbiBjYXNlIGlzIHRvIGxpc3RlbiBmb3IgdGhlIGAnbGluZSdgIGV2ZW50OlxuICpcbiAqIGBgYGpzXG4gKiBybC5vbignbGluZScsIChsaW5lKSA9PiB7XG4gKiAgIGNvbnNvbGUubG9nKGBSZWNlaXZlZDogJHtsaW5lfWApO1xuICogfSk7XG4gKiBgYGBcbiAqXG4gKiBJZiBgdGVybWluYWxgIGlzIGB0cnVlYCBmb3IgdGhpcyBpbnN0YW5jZSB0aGVuIHRoZSBgb3V0cHV0YCBzdHJlYW0gd2lsbCBnZXQgdGhlIGJlc3QgY29tcGF0aWJpbGl0eSBpZiBpdCBkZWZpbmVzIGFuIGBvdXRwdXQuY29sdW1uc2AgcHJvcGVydHksXG4gKiBhbmQgZW1pdHMgYSBgJ3Jlc2l6ZSdgIGV2ZW50IG9uIHRoZSBgb3V0cHV0YCwgaWYgb3Igd2hlbiB0aGUgY29sdW1ucyBldmVyIGNoYW5nZSAoYHByb2Nlc3Muc3Rkb3V0YCBkb2VzIHRoaXMgYXV0b21hdGljYWxseSB3aGVuIGl0IGlzIGEgVFRZKS5cbiAqXG4gKiAjIyBVc2Ugb2YgdGhlIGBjb21wbGV0ZXJgIGZ1bmN0aW9uXG4gKlxuICogVGhlIGBjb21wbGV0ZXJgIGZ1bmN0aW9uIHRha2VzIHRoZSBjdXJyZW50IGxpbmUgZW50ZXJlZCBieSB0aGUgdXNlciBhcyBhbiBhcmd1bWVudCwgYW5kIHJldHVybnMgYW4gYEFycmF5YCB3aXRoIDIgZW50cmllczpcbiAqXG4gKiAtIEFuIEFycmF5IHdpdGggbWF0Y2hpbmcgZW50cmllcyBmb3IgdGhlIGNvbXBsZXRpb24uXG4gKiAtIFRoZSBzdWJzdHJpbmcgdGhhdCB3YXMgdXNlZCBmb3IgdGhlIG1hdGNoaW5nLlxuICpcbiAqIEZvciBpbnN0YW5jZTogYFtbc3Vic3RyMSwgc3Vic3RyMiwgLi4uXSwgb3JpZ2luYWxzdWJzdHJpbmddYC5cbiAqXG4gKiBgYGBqc1xuICogZnVuY3Rpb24gY29tcGxldGVyKGxpbmUpIHtcbiAqICAgY29uc3QgY29tcGxldGlvbnMgPSAnLmhlbHAgLmVycm9yIC5leGl0IC5xdWl0IC5xJy5zcGxpdCgnICcpO1xuICogICBjb25zdCBoaXRzID0gY29tcGxldGlvbnMuZmlsdGVyKChjKSA9PiBjLnN0YXJ0c1dpdGgobGluZSkpO1xuICogICAvLyBTaG93IGFsbCBjb21wbGV0aW9ucyBpZiBub25lIGZvdW5kXG4gKiAgIHJldHVybiBbaGl0cy5sZW5ndGggPyBoaXRzIDogY29tcGxldGlvbnMsIGxpbmVdO1xuICogfVxuICogYGBgXG4gKlxuICogVGhlIGBjb21wbGV0ZXJgIGZ1bmN0aW9uIGNhbiBhbHNvIHJldHVybnMgYSBgUHJvbWlzZWAsIG9yIGJlIGFzeW5jaHJvbm91czpcbiAqXG4gKiBgYGBqc1xuICogYXN5bmMgZnVuY3Rpb24gY29tcGxldGVyKGxpbmVQYXJ0aWFsKSB7XG4gKiAgIGF3YWl0IHNvbWVBc3luY1dvcmsoKTtcbiAqICAgcmV0dXJuIFtbJzEyMyddLCBsaW5lUGFydGlhbF07XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUludGVyZmFjZShvcHRpb25zOiBSZWFkTGluZU9wdGlvbnMpOiBJbnRlcmZhY2U7XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlSW50ZXJmYWNlKFxuICBpbnB1dDogUmVhZGFibGVTdHJlYW0sXG4gIG91dHB1dD86IFdyaXRhYmxlU3RyZWFtLFxuICBjb21wbGV0ZXI/OiBDb21wbGV0ZXIgfCBBc3luY0NvbXBsZXRlcixcbiAgdGVybWluYWw/OiBib29sZWFuLFxuKTogSW50ZXJmYWNlO1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUludGVyZmFjZShcbiAgaW5wdXRPck9wdGlvbnM6IFJlYWRhYmxlU3RyZWFtIHwgUmVhZExpbmVPcHRpb25zLFxuICBvdXRwdXQ/OiBXcml0YWJsZVN0cmVhbSxcbiAgY29tcGxldGVyPzogQ29tcGxldGVyIHwgQXN5bmNDb21wbGV0ZXIsXG4gIHRlcm1pbmFsPzogYm9vbGVhbixcbik6IEludGVyZmFjZSB7XG4gIHJldHVybiBuZXcgSW50ZXJmYWNlKGlucHV0T3JPcHRpb25zLCBvdXRwdXQsIGNvbXBsZXRlciwgdGVybWluYWwpO1xufVxuXG5leHBvcnQgeyBSZWFkbGluZSB9O1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gIEludGVyZmFjZSxcbiAgUmVhZGxpbmUsXG4gIGNyZWF0ZUludGVyZmFjZSxcbn07XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsMEVBQTBFO0FBQzFFLDRFQUE0RTtBQUU1RSxTQUFTLFFBQVEsUUFBUSxvQ0FBb0M7QUFFN0QsU0FDRSxhQUFhLFVBQVUsRUFDdkIsU0FBUyxFQUNULGVBQWUsUUFDVixxQ0FBcUM7QUFDNUMsU0FBUyxVQUFVLFFBQVEsd0JBQXdCO0FBQ25ELFNBQVMsbUJBQW1CLFFBQVEsNkJBQTZCO0FBRWpFLFNBQVMsWUFBWSxRQUFRLHVCQUF1QjtBQXFEcEQsT0FBTyxNQUFNLGtCQUFrQjtJQUM3QixZQUNFLEtBQXVDLEVBQ3ZDLE1BQXVCLEVBQ3ZCLFNBQXNDLEVBQ3RDLFFBQWtCLENBQ2xCO1FBQ0EsS0FBSyxDQUFDLE9BQU8sUUFBUSxXQUFXO0lBQ2xDO0lBQ0EsU0FBUyxLQUFhLEVBQUUsVUFBcUIsWUFBWSxFQUFtQjtRQUMxRSxPQUFPLElBQUksUUFBUSxDQUFDLFNBQVMsU0FBVztZQUN0QyxJQUFJLEtBQUs7WUFFVCxJQUFJLFNBQVMsUUFBUTtnQkFDbkIsb0JBQW9CLFFBQVEsTUFBTSxFQUFFO2dCQUNwQyxJQUFJLFFBQVEsTUFBTSxDQUFDLE9BQU8sRUFBRTtvQkFDMUIsT0FBTyxPQUNMLElBQUksV0FBVyxXQUFXO3dCQUFFLE9BQU8sUUFBUSxNQUFNLENBQUMsTUFBTTtvQkFBQztnQkFFN0QsQ0FBQztnQkFFRCxNQUFNLFVBQVUsSUFBTTtvQkFDcEIsSUFBSSxDQUFDLGdCQUFnQjtvQkFDckIsT0FBTyxJQUFJLFdBQVcsV0FBVzt3QkFBRSxPQUFPLFFBQVMsTUFBTSxDQUFFLE1BQU07b0JBQUM7Z0JBQ3BFO2dCQUNBLFFBQVEsTUFBTSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsU0FBUztvQkFBRSxNQUFNLElBQUk7Z0JBQUM7Z0JBQy9ELEtBQUssQ0FBQyxTQUFXO29CQUNmLFFBQVMsTUFBTSxDQUFFLG1CQUFtQixDQUFDLFNBQVM7b0JBQzlDLFFBQVE7Z0JBQ1Y7WUFDRixDQUFDO1lBRUQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPO1FBQ3pCO0lBQ0Y7QUFDRixDQUFDO0FBMERELE9BQU8sU0FBUyxnQkFDZCxjQUFnRCxFQUNoRCxNQUF1QixFQUN2QixTQUFzQyxFQUN0QyxRQUFrQixFQUNQO0lBQ1gsT0FBTyxJQUFJLFVBQVUsZ0JBQWdCLFFBQVEsV0FBVztBQUMxRCxDQUFDO0FBRUQsU0FBUyxRQUFRLEdBQUc7QUFFcEIsZUFBZTtJQUNiO0lBQ0E7SUFDQTtBQUNGLEVBQUUifQ==