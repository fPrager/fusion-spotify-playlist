// Copyright 2018-2022 the Deno authors. All rights reserved. MIT license.
import { fromFileUrl } from "../path.ts";
import { promisify } from "../internal/util.mjs";
function getValidTime(time, name) {
    if (typeof time === "string") {
        time = Number(time);
    }
    if (typeof time === "number" && (Number.isNaN(time) || !Number.isFinite(time))) {
        throw new Deno.errors.InvalidData(`invalid ${name}, must not be infinity or NaN`);
    }
    return time;
}
export function utimes(path, atime, mtime, callback) {
    path = path instanceof URL ? fromFileUrl(path) : path;
    if (!callback) {
        throw new Deno.errors.InvalidData("No callback function supplied");
    }
    atime = getValidTime(atime, "atime");
    mtime = getValidTime(mtime, "mtime");
    Deno.utime(path, atime, mtime).then(()=>callback(null), callback);
}
export const utimesPromise = promisify(utimes);
export function utimesSync(path, atime, mtime) {
    path = path instanceof URL ? fromFileUrl(path) : path;
    atime = getValidTime(atime, "atime");
    mtime = getValidTime(mtime, "mtime");
    Deno.utimeSync(path, atime, mtime);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3N0ZEAwLjE2Ny4wL25vZGUvX2ZzL19mc191dGltZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTgtMjAyMiB0aGUgRGVubyBhdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLiBNSVQgbGljZW5zZS5cblxuaW1wb3J0IHR5cGUgeyBDYWxsYmFja1dpdGhFcnJvciB9IGZyb20gXCIuL19mc19jb21tb24udHNcIjtcbmltcG9ydCB7IGZyb21GaWxlVXJsIH0gZnJvbSBcIi4uL3BhdGgudHNcIjtcbmltcG9ydCB7IHByb21pc2lmeSB9IGZyb20gXCIuLi9pbnRlcm5hbC91dGlsLm1qc1wiO1xuXG5mdW5jdGlvbiBnZXRWYWxpZFRpbWUoXG4gIHRpbWU6IG51bWJlciB8IHN0cmluZyB8IERhdGUsXG4gIG5hbWU6IHN0cmluZyxcbik6IG51bWJlciB8IERhdGUge1xuICBpZiAodHlwZW9mIHRpbWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICB0aW1lID0gTnVtYmVyKHRpbWUpO1xuICB9XG5cbiAgaWYgKFxuICAgIHR5cGVvZiB0aW1lID09PSBcIm51bWJlclwiICYmXG4gICAgKE51bWJlci5pc05hTih0aW1lKSB8fCAhTnVtYmVyLmlzRmluaXRlKHRpbWUpKVxuICApIHtcbiAgICB0aHJvdyBuZXcgRGVuby5lcnJvcnMuSW52YWxpZERhdGEoXG4gICAgICBgaW52YWxpZCAke25hbWV9LCBtdXN0IG5vdCBiZSBpbmZpbml0eSBvciBOYU5gLFxuICAgICk7XG4gIH1cblxuICByZXR1cm4gdGltZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHV0aW1lcyhcbiAgcGF0aDogc3RyaW5nIHwgVVJMLFxuICBhdGltZTogbnVtYmVyIHwgc3RyaW5nIHwgRGF0ZSxcbiAgbXRpbWU6IG51bWJlciB8IHN0cmluZyB8IERhdGUsXG4gIGNhbGxiYWNrOiBDYWxsYmFja1dpdGhFcnJvcixcbikge1xuICBwYXRoID0gcGF0aCBpbnN0YW5jZW9mIFVSTCA/IGZyb21GaWxlVXJsKHBhdGgpIDogcGF0aDtcblxuICBpZiAoIWNhbGxiYWNrKSB7XG4gICAgdGhyb3cgbmV3IERlbm8uZXJyb3JzLkludmFsaWREYXRhKFwiTm8gY2FsbGJhY2sgZnVuY3Rpb24gc3VwcGxpZWRcIik7XG4gIH1cblxuICBhdGltZSA9IGdldFZhbGlkVGltZShhdGltZSwgXCJhdGltZVwiKTtcbiAgbXRpbWUgPSBnZXRWYWxpZFRpbWUobXRpbWUsIFwibXRpbWVcIik7XG5cbiAgRGVuby51dGltZShwYXRoLCBhdGltZSwgbXRpbWUpLnRoZW4oKCkgPT4gY2FsbGJhY2sobnVsbCksIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0IGNvbnN0IHV0aW1lc1Byb21pc2UgPSBwcm9taXNpZnkodXRpbWVzKSBhcyAoXG4gIHBhdGg6IHN0cmluZyB8IFVSTCxcbiAgYXRpbWU6IG51bWJlciB8IHN0cmluZyB8IERhdGUsXG4gIG10aW1lOiBudW1iZXIgfCBzdHJpbmcgfCBEYXRlLFxuKSA9PiBQcm9taXNlPHZvaWQ+O1xuXG5leHBvcnQgZnVuY3Rpb24gdXRpbWVzU3luYyhcbiAgcGF0aDogc3RyaW5nIHwgVVJMLFxuICBhdGltZTogbnVtYmVyIHwgc3RyaW5nIHwgRGF0ZSxcbiAgbXRpbWU6IG51bWJlciB8IHN0cmluZyB8IERhdGUsXG4pIHtcbiAgcGF0aCA9IHBhdGggaW5zdGFuY2VvZiBVUkwgPyBmcm9tRmlsZVVybChwYXRoKSA6IHBhdGg7XG4gIGF0aW1lID0gZ2V0VmFsaWRUaW1lKGF0aW1lLCBcImF0aW1lXCIpO1xuICBtdGltZSA9IGdldFZhbGlkVGltZShtdGltZSwgXCJtdGltZVwiKTtcblxuICBEZW5vLnV0aW1lU3luYyhwYXRoLCBhdGltZSwgbXRpbWUpO1xufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLDBFQUEwRTtBQUcxRSxTQUFTLFdBQVcsUUFBUSxhQUFhO0FBQ3pDLFNBQVMsU0FBUyxRQUFRLHVCQUF1QjtBQUVqRCxTQUFTLGFBQ1AsSUFBNEIsRUFDNUIsSUFBWSxFQUNHO0lBQ2YsSUFBSSxPQUFPLFNBQVMsVUFBVTtRQUM1QixPQUFPLE9BQU87SUFDaEIsQ0FBQztJQUVELElBQ0UsT0FBTyxTQUFTLFlBQ2hCLENBQUMsT0FBTyxLQUFLLENBQUMsU0FBUyxDQUFDLE9BQU8sUUFBUSxDQUFDLEtBQUssR0FDN0M7UUFDQSxNQUFNLElBQUksS0FBSyxNQUFNLENBQUMsV0FBVyxDQUMvQixDQUFDLFFBQVEsRUFBRSxLQUFLLDZCQUE2QixDQUFDLEVBQzlDO0lBQ0osQ0FBQztJQUVELE9BQU87QUFDVDtBQUVBLE9BQU8sU0FBUyxPQUNkLElBQWtCLEVBQ2xCLEtBQTZCLEVBQzdCLEtBQTZCLEVBQzdCLFFBQTJCLEVBQzNCO0lBQ0EsT0FBTyxnQkFBZ0IsTUFBTSxZQUFZLFFBQVEsSUFBSTtJQUVyRCxJQUFJLENBQUMsVUFBVTtRQUNiLE1BQU0sSUFBSSxLQUFLLE1BQU0sQ0FBQyxXQUFXLENBQUMsaUNBQWlDO0lBQ3JFLENBQUM7SUFFRCxRQUFRLGFBQWEsT0FBTztJQUM1QixRQUFRLGFBQWEsT0FBTztJQUU1QixLQUFLLEtBQUssQ0FBQyxNQUFNLE9BQU8sT0FBTyxJQUFJLENBQUMsSUFBTSxTQUFTLElBQUksR0FBRztBQUM1RCxDQUFDO0FBRUQsT0FBTyxNQUFNLGdCQUFnQixVQUFVLFFBSXBCO0FBRW5CLE9BQU8sU0FBUyxXQUNkLElBQWtCLEVBQ2xCLEtBQTZCLEVBQzdCLEtBQTZCLEVBQzdCO0lBQ0EsT0FBTyxnQkFBZ0IsTUFBTSxZQUFZLFFBQVEsSUFBSTtJQUNyRCxRQUFRLGFBQWEsT0FBTztJQUM1QixRQUFRLGFBQWEsT0FBTztJQUU1QixLQUFLLFNBQVMsQ0FBQyxNQUFNLE9BQU87QUFDOUIsQ0FBQyJ9